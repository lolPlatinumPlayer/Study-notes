了解思极视界与其衍生项目的关系

继承进框架

@name_cn

`<demo></demo>`

importers加面板后转向有几率不正确

图片默认值用base64

## 待做事项

- 多路径扫光（3-4天）（与Area3D用同一份数据源）  

  - 着色器粒子扩散效果  
  - 下载博客代码搞定近大远小  

- 与地图联动方式更改（4-8天）

- 雨（3-4天）（要贴近地面）

- 线框围栏  

  路径上升的那个效果  

  

## 非紧急事项

- 可能有的bug：镭射组件的3DPath-1-5.geojson部分线段速度会变慢

- JxColor
  - 色相偏移方法
  - 代码整理
  - 文档
  
- 彗星 
  
  - 尾巴没颜色
  
- 路径动画

  *[数字]是自己排的重要等级，[1]为最重要*

  - 实时获取坐标并响应 [2]
  - 中途变速 [3]
  - 依据多次获取的坐标自动应用预测速度 [5]
  - 中途路径的改变 [6]
  - 路径改变后继续保留为改变部分路径，方便走到底后进行循环 [7]

- GeoPlane

  - html内容的支持
  - 真正“Plane”的支持
  - 有空尝试解决模糊问题
    - 有可能是尺寸不是2的幂导致的
  - 有时间尝试不输入html宽高

- GeoPlane等的替换销毁

  包括`map.on("move"`

- 组件模块增加函数

- 镭射注释添加

- 粒子轨迹整理代码
  
  - 包括wholePath的命名
  
- fileTo3D
  - 写一个方法返回克隆后的物体
  - 考虑多实例加载同文件的问题
  
- importers
  - 动画模型
    - 动画名列表
    - 模型动画的name（c4d动画轨道名）的修改方法
    - 蒙皮骨骼模型的支持
    - gltf动画测试
    - 一个物体多个动画的支持
  
- tween改es6-tween


## GeoGL可优化空间

- 路径动画控制台

  可以让多个组件路径动画联动

  并且可以避免每个组件各自拥有路径动画代码

- 许多方法在多个组件重复出现

  如：显隐组件、批量偏移子项、数据源解析

- 错误统一处理

- 将“app”放在框架内部而不是让用户自己`new`  

  这样就不必等`addTo`结束后才能获取“app”，组件嵌套的情况也能更方便地获取“app”

##  GeoGL

- 思极纬度偏移并不是按真实地球（赤道突出的椭圆）来的  

  有可能是相反的（南北极突出）   

- 缩放  

  `scale`要放`setTimeout 0`里，不然会被覆盖

- 高性能开关记录

  **关闭**
  不看 4 44
  看 1 39

  **开启**
  不看 4 44
  看 1 32
  
- 彗星性能记录

  慧尾顶点数量  帧率  情况

  - 720  41-44  普通彗星一颗
  - 3600  39-42  普通彗星一实例五颗
  - 3360  36-38  普通彗星多实例
  - 3000  31-32  彗星轨道一实例多轨道

- 对于不符合条件的传参，也要让程序能合理执行

## 待研究内容

- tween
  - 研究下tween的版本与相关资料
  - 下载tween
- 光照
- 真正的光晕（雾）
- 不开`depthTest`无法正常显示的问题
- 旋转rotation、lookAt、四元数

## 性能测试

多立方体，总顶点20w，全显示21帧，显示800左右个顶点60帧

多立方体，总顶点200w，全显示2帧，显示32个顶点10帧

100个多顶点缓冲mesh，总顶点1.2kw，全显示35帧，显示部分60帧

200个多顶点缓冲mesh，总顶点2.4kw，全显示22帧，显示部分60帧

## tween

- `TWEEN.update(时间)`这个方法就算传入准确的时间差会延迟开始（时间差是指当前时间到第一次调用`update`之间的时间差）  

  延迟时间不定  
  
  而且在性能极限情况下会出现数值闪动  
  
  彗星组件中一个实例超过两个彗星也会无法开始
  
- 在从一个`TWEEN.Tween`实例到另一个实例的那一帧  

  会按顺序执行两个实例的`onUpdate`  

- 多次调用  

  - `to`  

    `onUpdate`不会重叠执行  

    在没有`stop`的情况下会时间跳跃（解决方案：同一帧内`stop`后`to`后`start`）  

  - `start`  

    `onUpdate`会重叠执行

- “TWEEN.Tween实例”的`stop`  

  会按顺序触发其`chain`链上的`onStop` （https://cdnjs.cloudflare.com/ajax/libs/tween.js/16.3.5/Tween.min.js）
  
- 一个“TWEEN.Tween实例”的`onComplete`里无法调用自己的`start`bug  （17.3.5的"src/Tween.js"会）（https://cdnjs.cloudflare.com/ajax/libs/tween.js/16.3.5/Tween.min.js的不会）

  允许调用的方法：将`start`放进`setTimeout 0`内
  
- 获取正在运行的tween实例

  `TWEEN.getAll()`

  返回一个数组

- 回调没有队列

  已测试：`onComplete`

## jsdoc

- **序号后无空行bug**  

  在序号后加一行空行并加一行`<i></i>`即可
  

## 进度记录

- 看到
“context.arc”——掘金博客
“Math.random(), Math.random(), Math.random(), 1,”
- RPC failed; curl 56 OpenSSL SSL_read: SSL_ERROR_SYSCALL, errno 10054
  fatal: The remote end hung up unexpectedly
  fatal: early EOF
  fatal: index-pack failed